(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     35106,        740]
NotebookOptionsPosition[     34119,        706]
NotebookOutlinePosition[     34905,        734]
CellTagsIndexPosition[     34831,        729]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "Out", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$HistoryLength", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", 
    RowBox[{"\"\<HCMP`\>\"", ",", 
     RowBox[{
     "URLDownload", "[", 
      "\"\<https://raw.githubusercontent.com/wqfang/HCMP_Project/master/src/\
HCMP.wl\>\"", "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CenterMessageDialog", "[", "text_", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"apc", "=", "AbsoluteCurrentValue"}], "}"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"parentCenter", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"apc", "[", "WindowMargins", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "1"}], "]"}], "]"}], "+", 
              RowBox[{".5", " ", 
               RowBox[{"apc", "[", "WindowSize", "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"MessageDialog", "[", 
          RowBox[{"text", ",", "\[IndentingNewLine]", 
           RowBox[{"NotebookDynamicExpression", "\[RuleDelayed]", 
            RowBox[{"Refresh", "[", 
             RowBox[{
              RowBox[{"SetOptions", "[", 
               RowBox[{
                RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
                RowBox[{"WindowMargins", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"parentCenter", "-", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{".5", " ", 
                    RowBox[{"apc", "[", "WindowSize", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}]}], ")"}]}],
                 ",", 
                RowBox[{"NotebookDynamicExpression", "\[Rule]", "None"}]}], 
               "]"}], ",", "None"}], "]"}]}]}], "]"}], ";"}]}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "DefaultDir", " ", "=", " ", 
     "\"\</Users/wenqiangfang/Dropbox \
(Brown)/research/HCP_Forces/Meeting_April/ExampleData/20190909Set1\>\""}], 
    ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Panel", "[", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Work Dir: \>\"", "<>", "WorkDir"}], ",", 
           "SpanFromLeft"}], "}"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Number of Particles: \>\"", "<>", 
            RowBox[{"IntegerString", "[", "NoBeads", "]"}]}], ",", 
           "SpanFromLeft"}], "}"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<Number of Deformed Configurations: \>\"", "<>", 
            RowBox[{"IntegerString", "[", "NoConfgs", "]"}]}], ",", 
           "SpanFromLeft"}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "}"}]}]}],
       "]"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
     RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"WorkDir", ",", "\"\<Null\>\""}], "}"}], ",", "None"}], "}"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"WorkDir", ",", "DefaultDir"}], "}"}], ",", "None"}], "}"}]}],
     "*)"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NoBeads", ",", "0"}], "}"}], ",", "None"}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NoConfgs", ",", "0"}], "}"}], ",", "None"}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ParticlePre", "=", " ", "\"\<Particle\>\""}], ",", 
       RowBox[{"TimePre", "=", "\"\<Time\>\""}], ",", "\[IndentingNewLine]", 
       "PtcList", ",", "PtcNo", ",", "PtcName", ",", "GDirR", ",", "GDirD", 
       ",", 
       RowBox[{"MeshRefineFactor", "=", "0.05"}], "\[IndentingNewLine]", ",", 
       
       RowBox[{"rList", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Vol2List", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Vol1List", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"AvgBdList", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"EEDensityList", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"EEList", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"outf", "=", "Null"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<Parallel processing of massive data set\>\"", ",", "20"}], 
            "]"}], ",", "SpanFromLeft", ",", "SpanFromLeft"}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Button", "[", 
            RowBox[{
            "\"\<Choose working directory of the project\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"WorkDir", "=", 
               RowBox[{"SystemDialogInput", "[", 
                RowBox[{"\"\<Directory\>\"", ",", 
                 RowBox[{
                 "WindowTitle", "\[Rule]", 
                  "\"\<Choose working directory\>\""}]}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
           "SpanFromLeft", ",", "SpanFromLeft"}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Item", "[", 
            RowBox[{"\"\<Prefix for Particle folders\>\"", ",", 
             RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}], ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "ParticlePre", "]"}], ",", "String"}], 
            "]"}], ",", 
           RowBox[{"Dynamic", "[", "ParticlePre", "]"}]}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Item", "[", 
            RowBox[{"\"\<Prefix for Time folders\>\"", ",", 
             RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}], ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "TimePre", "]"}], ",", "String"}], "]"}],
            ",", 
           RowBox[{"Dynamic", "[", "TimePre", "]"}]}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Button", "[", 
            RowBox[{
            "\"\<Calculate the Number of Beads and Deformed \
Configurations\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"WorkDir", "===", "$Canceled"}], "||", 
                 RowBox[{"WorkDir", "===", "\"\<Null\>\""}]}], ",", 
                RowBox[{
                 RowBox[{
                 "CenterMessageDialog", "[", 
                  "\"\<Please Choose working directory of the project.\>\"", 
                  "]"}], ";"}], "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"PtcList", ",", "PtcNo", ",", "PtcName"}], "}"}], 
                  "=", 
                  RowBox[{"Child", "[", 
                   RowBox[{"WorkDir", ",", "ParticlePre"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"GDirR", ",", "GDirD"}], "}"}], "=", 
                  RowBox[{"Child", "[", 
                   RowBox[{"WorkDir", ",", "ParticlePre", ",", "TimePre"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"NoBeads", ",", "NoConfgs"}], "}"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"PtcList", "//", "Length"}], ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Length", "/@", "GDirD"}], "]"}]}], "}"}]}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ",", 
           "SpanFromLeft", ",", "SpanFromLeft"}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Item", "[", 
            RowBox[{"\"\<Mesh Refine Factor\>\"", ",", 
             RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}], ",", 
           RowBox[{"Item", "[", 
            RowBox[{
             RowBox[{"PopupMenu", "[", 
              RowBox[{
               RowBox[{"Dynamic", "@", "MeshRefineFactor"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "0.01", ",", "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",",
                  "0.5", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
             RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], ",", " ", 
           RowBox[{"Dynamic", "[", "MeshRefineFactor", "]"}]}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Button", "[", 
            RowBox[{
            "\"\<Perform Finite Element Calculation\>\"", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"NoBeads", "===", "0"}], ")"}], "||", 
                 RowBox[{"NoConfgs", "===", "0"}]}], ",", 
                RowBox[{
                 RowBox[{
                 "CenterMessageDialog", "[", 
                  "\"\<Please Calculate the Number of Beads and Deformed \
Configurations.\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{"ParallelEvaluate", "[", 
                  RowBox[{"$HistoryLength", "=", "0"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "rList", ",", "Vol2List", ",", "Vol1List", ",", 
                    "AvgBdList", ",", "EEDensityList", ",", "EEList"}], "}"}],
                   "=", 
                  RowBox[{"FEMAll", "[", 
                   RowBox[{
                   "GDirR", ",", "GDirD", ",", "NoBeads", ",", 
                    "MeshRefineFactor"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                 "CenterMessageDialog", "[", 
                  "\"\<Finite Element Calculation is done.\>\"", "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
           "SpanFromLeft", ",", "SpanFromLeft"}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Button", "[", 
            RowBox[{
            "\"\<Output Results to Excel\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rList", "===", "0"}], ",", 
                RowBox[{
                 RowBox[{
                 "CenterMessageDialog", "[", 
                  "\"\<Please Perform Finite Element Calculation.\>\"", "]"}],
                  ";"}], "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{"outf", "=", 
                  RowBox[{"SystemDialogInput", "[", 
                   RowBox[{"\"\<FileSave\>\"", ",", 
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"WorkDir", ",", "\"\<ResultSheet.xls\>\""}], 
                    "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"OutExcel", "[", 
                  RowBox[{
                  "outf", ",", "NoBeads", ",", "PtcName", ",", "GDirD", ",", 
                   "rList", ",", "Vol2List", ",", "Vol1List", ",", 
                   "AvgBdList", ",", "EEDensityList", ",", "EEList"}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"SystemOpen", "[", "outf", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
           "SpanFromLeft", ",", "SpanFromLeft"}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"{", 
           RowBox[{"0.8", ",", 
            RowBox[{"2", "\[Rule]", "2"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
       RowBox[{"BaseStyle", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontSize", "\[Rule]", "13"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "}"}]}]}],
       "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"ContinuousAction", "\[Rule]", "False"}], ",", 
   RowBox[{"LocalizeVariables", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 ShowCellBracket->False,
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{
  3.7772212306283407`*^9, {3.7772212790657387`*^9, 3.777221285037827*^9}, {
   3.777221360148245*^9, 3.7772213934349422`*^9}, {3.777225555671623*^9, 
   3.777225559287475*^9}, {3.777317809255889*^9, 3.777317835010441*^9}, 
   3.777320148393285*^9, {3.777320259573661*^9, 3.7773202791545877`*^9}, 
   3.777320488794653*^9, 3.777320540856626*^9, {3.777320762203196*^9, 
   3.777320762449278*^9}, {3.777321425947147*^9, 3.7773214263228703`*^9}, {
   3.777321527048522*^9, 3.7773215274849377`*^9}, {3.777322202348584*^9, 
   3.7773223477027407`*^9}, {3.7773224219411783`*^9, 3.777322438228956*^9}, 
   3.7773369949513407`*^9, {3.777548361538313*^9, 3.777548366588513*^9}, 
   3.7775485475464973`*^9, {3.777551326528316*^9, 3.777551326696303*^9}, {
   3.7775521547834597`*^9, 3.7775521621272087`*^9}, {3.777637217557427*^9, 
   3.777637229548287*^9}, {3.777639870895228*^9, 3.777639872757724*^9}, {
   3.7776514270204477`*^9, 3.777651430303686*^9}, {3.777722353776066*^9, 
   3.77772255493244*^9}, {3.7777228412368717`*^9, 3.777722841438424*^9}, {
   3.7777229949365797`*^9, 3.7777229989726*^9}, {3.77772340043242*^9, 
   3.777723461014629*^9}, {3.777723972645927*^9, 3.777723972844488*^9}, {
   3.777725501294113*^9, 3.777725525602417*^9}, {3.778348818950268*^9, 
   3.778348821120597*^9}, {3.778426961119637*^9, 3.778426961267427*^9}, {
   3.778427194596244*^9, 3.7784273002271023`*^9}, {3.7784322022107563`*^9, 
   3.778432204382806*^9}, {3.7784330250023518`*^9, 3.778433034273645*^9}, {
   3.793387996168491*^9, 3.79338799630293*^9}, {3.79344932767968*^9, 
   3.793449340345228*^9}, 3.793451089270419*^9, {3.793451328371174*^9, 
   3.7934513402014723`*^9}, {3.793540588880718*^9, 3.793540601368032*^9}, {
   3.793558711448823*^9, 3.7935587513916492`*^9}, {3.793558810162828*^9, 
   3.793558860434119*^9}, {3.793559001616376*^9, 3.79355900509382*^9}, {
   3.794829001474785*^9, 3.794829062278193*^9}, {3.794829121939006*^9, 
   3.7948291571082373`*^9}, 3.794829188607361*^9, {3.794829219604529*^9, 
   3.794829231859544*^9}, {3.79482931938554*^9, 3.7948295573968763`*^9}, {
   3.794829593699039*^9, 3.794829677748069*^9}, {3.7948297295550213`*^9, 
   3.794829968128028*^9}, {3.7948302711466703`*^9, 3.794830343630253*^9}, {
   3.794831530965164*^9, 3.7948315321277122`*^9}, {3.794831594270637*^9, 
   3.794831623268503*^9}, {3.794831666137271*^9, 3.794831790120384*^9}, 
   3.794831876845457*^9, {3.794832011516234*^9, 3.794832044883799*^9}, {
   3.794832282806986*^9, 3.7948322829168787`*^9}, {3.794832327012512*^9, 
   3.7948323533729143`*^9}, {3.7948326361051407`*^9, 3.794832672497837*^9}, {
   3.794854600784218*^9, 3.7948547588174267`*^9}, {3.794854951614814*^9, 
   3.794854957786845*^9}, 3.79485502019886*^9, 3.794855075410099*^9, {
   3.7948644532137527`*^9, 3.794864602712802*^9}, {3.7948665070870647`*^9, 
   3.7948665073259153`*^9}, {3.794866935797415*^9, 3.794866936747302*^9}, {
   3.794867159007394*^9, 3.794867159161726*^9}, 3.794868468866667*^9, 
   3.794868643279429*^9, {3.7948686943180227`*^9, 3.79486872764536*^9}, {
   3.794868783417634*^9, 3.7948688424899406`*^9}, {3.7949174655456247`*^9, 
   3.794917503573102*^9}, {3.794917578091261*^9, 3.7949176064729767`*^9}, {
   3.79491788815447*^9, 3.7949180134752617`*^9}, 3.794918882383586*^9, {
   3.7949189831591253`*^9, 3.794918990558001*^9}, {3.7949226910794983`*^9, 
   3.7949226918824663`*^9}, {3.79493601079126*^9, 3.794936033572919*^9}, {
   3.794937380254841*^9, 3.794937394204914*^9}, {3.7949374284264812`*^9, 
   3.794937438992372*^9}, {3.7949374936969423`*^9, 3.794937573231902*^9}, {
   3.794937736072279*^9, 3.7949378057671537`*^9}, {3.7949379632253113`*^9, 
   3.79493796746493*^9}, {3.794938093058096*^9, 3.794938100088407*^9}, {
   3.7949381733401737`*^9, 3.794938237949492*^9}, {3.794938372804263*^9, 
   3.7949384968602943`*^9}, 3.794938908741762*^9, {3.794941268807006*^9, 
   3.794941269386777*^9}, {3.795011149919469*^9, 3.795011155996112*^9}, {
   3.795013526851828*^9, 3.795013545797525*^9}, 3.7950135945532207`*^9, {
   3.7950147194062967`*^9, 3.7950147429252357`*^9}, 3.795016027680941*^9, {
   3.7950179195341053`*^9, 3.7950179481149807`*^9}, {3.795017978949079*^9, 
   3.7950179980771227`*^9}, {3.795018030052774*^9, 3.795018033980783*^9}, {
   3.795018165841682*^9, 3.795018166568097*^9}, {3.79501976854111*^9, 
   3.795019773378344*^9}, {3.795022479479409*^9, 3.79502248906843*^9}, {
   3.795036886080853*^9, 3.7950368864571743`*^9}, {3.795037353315967*^9, 
   3.7950373760402308`*^9}, {3.7950374069733343`*^9, 3.795037407436451*^9}, {
   3.7950374692322683`*^9, 3.795037502760215*^9}, {3.795041131744323*^9, 
   3.795041141598393*^9}, {3.7950895173104887`*^9, 3.7950895319352016`*^9}, {
   3.795089600832*^9, 3.795089634336095*^9}, {3.79510105909673*^9, 
   3.795101068477962*^9}, {3.79510168234894*^9, 3.7951017148206263`*^9}, {
   3.795102947590764*^9, 3.795102954210952*^9}, {3.795103579916685*^9, 
   3.7951036553374166`*^9}, {3.7951036908655977`*^9, 3.7951037014818497`*^9}, 
   3.795103841954015*^9, {3.7951042094785147`*^9, 3.795104214512267*^9}, {
   3.795189473410431*^9, 3.795189473450289*^9}, {3.795211392840122*^9, 
   3.7952114575288763`*^9}, 3.795213146278661*^9, {3.795214140489195*^9, 
   3.795214140599291*^9}, 3.795214254210926*^9, {3.795727896737178*^9, 
   3.795727902194139*^9}, {3.795727938452917*^9, 3.795727955220483*^9}, {
   3.795727987310028*^9, 3.79572799162031*^9}, {3.795728022034685*^9, 
   3.795728023297665*^9}, {3.795872331429582*^9, 3.795872342526787*^9}, {
   3.795872391438223*^9, 3.7958724410992947`*^9}, {3.7958725425763607`*^9, 
   3.795872546309072*^9}, {3.7958726876019363`*^9, 3.795872688066636*^9}, 
   3.795872847369153*^9, 3.795872897777985*^9, {3.797003465419745*^9, 
   3.797003475201911*^9}, {3.7976163426277723`*^9, 3.7976163438922033`*^9}, {
   3.797616414663587*^9, 3.797616417468925*^9}, {3.797617353543652*^9, 
   3.797617354500523*^9}, {3.797617482157632*^9, 3.7976175124674273`*^9}, 
   3.7976175811783247`*^9, {3.797617633962377*^9, 3.797617635485965*^9}, {
   3.797624202460401*^9, 3.797624270779847*^9}, {3.797624432714377*^9, 
   3.797624435798129*^9}, {3.797624756060416*^9, 3.7976247661380873`*^9}},
 Background->GrayLevel[1],
 CellTags->"Subroutines",
 CellLabel->"In[1]:=",ExpressionUUID->"53a05a53-bebd-41d8-a437-67f0abca7cf6"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`NoBeads$$ = 0, $CellContext`NoConfgs$$ = 
    0, $CellContext`WorkDir$$ = "Null", Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`WorkDir$$], "Null"}, 0}, {{
       Hold[$CellContext`NoBeads$$], 0}, 0}, {{
       Hold[$CellContext`NoConfgs$$], 0}, 0}, {
      Hold[
       DynamicModule[{$CellContext`ParticlePre = 
         "Particle", $CellContext`TimePre = 
         "Time", $CellContext`PtcList, $CellContext`PtcNo, \
$CellContext`PtcName, $CellContext`GDirR, $CellContext`GDirD, \
$CellContext`MeshRefineFactor = 
         0.05, $CellContext`rList = {}, $CellContext`Vol2List = {}, \
$CellContext`Vol1List = {}, $CellContext`AvgBdList = {}, \
$CellContext`EEDensityList = {}, $CellContext`EEList = {}, $CellContext`outf = 
         Null}, 
        Grid[{{
           Style["Parallel processing of massive data set", 20], SpanFromLeft,
            SpanFromLeft}, {
           Button[
           "Choose working directory of the project", $CellContext`WorkDir$$ = 
             SystemDialogInput[
              "Directory", WindowTitle -> "Choose working directory"]; Null, 
            Method -> "Queued", ImageSize -> 300], SpanFromLeft, 
           SpanFromLeft}, {
           Item["Prefix for Particle folders", Alignment -> Right], 
           InputField[
            Dynamic[$CellContext`ParticlePre], String], 
           Dynamic[$CellContext`ParticlePre]}, {
           Item["Prefix for Time folders", Alignment -> Right], 
           InputField[
            Dynamic[$CellContext`TimePre], String], 
           Dynamic[$CellContext`TimePre]}, {
           Button[
           "Calculate the Number of Beads and Deformed Configurations", If[
              
              Or[$CellContext`WorkDir$$ === $Canceled, $CellContext`WorkDir$$ === 
               "Null"], $CellContext`CenterMessageDialog[
               "Please Choose working directory of the project."]; 
              
              Null, {$CellContext`PtcList, $CellContext`PtcNo, \
$CellContext`PtcName} = 
               HCMP`Child[$CellContext`WorkDir$$, $CellContext`ParticlePre]; \
{$CellContext`GDirR, $CellContext`GDirD} = 
               HCMP`Child[$CellContext`WorkDir$$, $CellContext`ParticlePre, \
$CellContext`TimePre]; {$CellContext`NoBeads$$, $CellContext`NoConfgs$$} = {
                 Length[$CellContext`PtcList], 
                 Total[
                  Map[Length, $CellContext`GDirD]]}; Null]; Null, Method -> 
            "Queued", ImageSize -> 400], SpanFromLeft, SpanFromLeft}, {
           Item["Mesh Refine Factor", Alignment -> Right], 
           Item[
            PopupMenu[
             Dynamic[$CellContext`MeshRefineFactor], {
             0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1, 2}], Alignment -> Left], 
           Dynamic[$CellContext`MeshRefineFactor]}, {
           Button["Perform Finite Element Calculation", If[
              
              Or[$CellContext`NoBeads$$ === 0, $CellContext`NoConfgs$$ === 
               0], $CellContext`CenterMessageDialog[
               "Please Calculate the Number of Beads and Deformed \
Configurations."]; Null, 
              ParallelEvaluate[$HistoryLength = 
                0]; {$CellContext`rList, $CellContext`Vol2List, \
$CellContext`Vol1List, $CellContext`AvgBdList, $CellContext`EEDensityList, \
$CellContext`EEList} = 
               HCMP`FEMAll[$CellContext`GDirR, $CellContext`GDirD, \
$CellContext`NoBeads$$, $CellContext`MeshRefineFactor]; \
$CellContext`CenterMessageDialog["Finite Element Calculation is done."]; 
              Null]; Null, Method -> "Queued", ImageSize -> 300], 
           SpanFromLeft, SpanFromLeft}, {
           Button[
           "Output Results to Excel", 
            If[$CellContext`rList === 
              0, $CellContext`CenterMessageDialog[
               "Please Perform Finite Element Calculation."]; 
              Null, $CellContext`outf = SystemDialogInput["FileSave", 
                 FileNameJoin[{$CellContext`WorkDir$$, "ResultSheet.xls"}]]; 
              HCMP`OutExcel[$CellContext`outf, $CellContext`NoBeads$$, \
$CellContext`PtcName, $CellContext`GDirD, $CellContext`rList, \
$CellContext`Vol2List, $CellContext`Vol1List, $CellContext`AvgBdList, \
$CellContext`EEDensityList, $CellContext`EEList]; 
              SystemOpen[$CellContext`outf]; Null]; Null, Method -> "Queued", 
            ImageSize -> 300], SpanFromLeft, SpanFromLeft}}, 
         Spacings -> {1, {0.8, 2 -> 2}}, Alignment -> Center, 
         BaseStyle -> {FontSize -> 13, FontFamily -> "Helvetica"}], 
        DynamicModuleValues :> {}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {450., {35., 40.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`NoBeads$$ = 0, $CellContext`NoConfgs$$ = 
        0, $CellContext`WorkDir$$ = "Null"}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Panel[
        Grid[{{
           StringJoin["Work Dir: ", $CellContext`WorkDir$$], SpanFromLeft}, {
           StringJoin["Number of Particles: ", 
            IntegerString[$CellContext`NoBeads$$]], SpanFromLeft}, {
           StringJoin["Number of Deformed Configurations: ", 
            IntegerString[$CellContext`NoConfgs$$]], SpanFromLeft}}, 
         Alignment -> Left, 
         BaseStyle -> {FontSize -> 14, FontFamily -> "Helvetica"}], ImageSize -> 
        450, Background -> White], 
      "Specifications" :> {{{$CellContext`WorkDir$$, "Null"}, 0, ControlType -> 
         None}, {{$CellContext`NoBeads$$, 0}, 0, ControlType -> 
         None}, {{$CellContext`NoConfgs$$, 0}, 0, ControlType -> None}, 
        DynamicModule[{$CellContext`ParticlePre = 
          "Particle", $CellContext`TimePre = 
          "Time", $CellContext`PtcList, $CellContext`PtcNo, \
$CellContext`PtcName, $CellContext`GDirR, $CellContext`GDirD, \
$CellContext`MeshRefineFactor = 
          0.05, $CellContext`rList = {}, $CellContext`Vol2List = {}, \
$CellContext`Vol1List = {}, $CellContext`AvgBdList = {}, \
$CellContext`EEDensityList = {}, $CellContext`EEList = {}, $CellContext`outf = 
          Null}, 
         Grid[{{
            Style["Parallel processing of massive data set", 20], 
            SpanFromLeft, SpanFromLeft}, {
            Button[
            "Choose working directory of the project", $CellContext`WorkDir$$ = 
              SystemDialogInput[
               "Directory", WindowTitle -> "Choose working directory"]; Null, 
             Method -> "Queued", ImageSize -> 300], SpanFromLeft, 
            SpanFromLeft}, {
            Item["Prefix for Particle folders", Alignment -> Right], 
            InputField[
             Dynamic[$CellContext`ParticlePre], String], 
            Dynamic[$CellContext`ParticlePre]}, {
            Item["Prefix for Time folders", Alignment -> Right], 
            InputField[
             Dynamic[$CellContext`TimePre], String], 
            Dynamic[$CellContext`TimePre]}, {
            Button[
            "Calculate the Number of Beads and Deformed Configurations", If[
               
               Or[$CellContext`WorkDir$$ === $Canceled, \
$CellContext`WorkDir$$ === "Null"], $CellContext`CenterMessageDialog[
                "Please Choose working directory of the project."]; 
               Null, {$CellContext`PtcList, $CellContext`PtcNo, \
$CellContext`PtcName} = 
                HCMP`Child[$CellContext`WorkDir$$, $CellContext`ParticlePre]; \
{$CellContext`GDirR, $CellContext`GDirD} = 
                HCMP`Child[$CellContext`WorkDir$$, $CellContext`ParticlePre, \
$CellContext`TimePre]; {$CellContext`NoBeads$$, $CellContext`NoConfgs$$} = {
                  Length[$CellContext`PtcList], 
                  Total[
                   Map[Length, $CellContext`GDirD]]}; Null]; Null, Method -> 
             "Queued", ImageSize -> 400], SpanFromLeft, SpanFromLeft}, {
            Item["Mesh Refine Factor", Alignment -> Right], 
            Item[
             PopupMenu[
              Dynamic[$CellContext`MeshRefineFactor], {
              0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1, 2}], Alignment -> Left], 
            Dynamic[$CellContext`MeshRefineFactor]}, {
            Button["Perform Finite Element Calculation", If[
               
               Or[$CellContext`NoBeads$$ === 0, $CellContext`NoConfgs$$ === 
                0], $CellContext`CenterMessageDialog[
                "Please Calculate the Number of Beads and Deformed \
Configurations."]; Null, 
               ParallelEvaluate[$HistoryLength = 
                 0]; {$CellContext`rList, $CellContext`Vol2List, \
$CellContext`Vol1List, $CellContext`AvgBdList, $CellContext`EEDensityList, \
$CellContext`EEList} = 
                HCMP`FEMAll[$CellContext`GDirR, $CellContext`GDirD, \
$CellContext`NoBeads$$, $CellContext`MeshRefineFactor]; \
$CellContext`CenterMessageDialog["Finite Element Calculation is done."]; 
               Null]; Null, Method -> "Queued", ImageSize -> 300], 
            SpanFromLeft, SpanFromLeft}, {
            Button[
            "Output Results to Excel", 
             If[$CellContext`rList === 
               0, $CellContext`CenterMessageDialog[
                "Please Perform Finite Element Calculation."]; 
               Null, $CellContext`outf = SystemDialogInput["FileSave", 
                  FileNameJoin[{$CellContext`WorkDir$$, "ResultSheet.xls"}]]; 
               HCMP`OutExcel[$CellContext`outf, $CellContext`NoBeads$$, \
$CellContext`PtcName, $CellContext`GDirD, $CellContext`rList, \
$CellContext`Vol2List, $CellContext`Vol1List, $CellContext`AvgBdList, \
$CellContext`EEDensityList, $CellContext`EEList]; 
               SystemOpen[$CellContext`outf]; Null]; Null, Method -> "Queued",
              ImageSize -> 300], SpanFromLeft, SpanFromLeft}}, 
          Spacings -> {1, {0.8, 2 -> 2}}, Alignment -> Center, 
          BaseStyle -> {FontSize -> 13, FontFamily -> "Helvetica"}], 
         DynamicModuleValues :> {}]}, 
      "Options" :> {ContinuousAction -> False, LocalizeVariables -> True}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{495., {209., 215.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 ShowCellBracket->True,
 CellOpen->True,
 CellChangeTimes->{
  3.795210158319487*^9, 3.795210317045257*^9, 3.795210660404786*^9, 
   3.795210756327499*^9, 3.795210939869691*^9, 3.795210983955777*^9, 
   3.795211050531068*^9, 3.795211280257023*^9, 3.7952116175783978`*^9, 
   3.7952119503164186`*^9, 3.795212061936363*^9, 3.795212723125416*^9, 
   3.795212978407323*^9, 3.795213015006384*^9, 3.795213137501205*^9, 
   3.79521318467653*^9, {3.7952141208695297`*^9, 3.795214145418344*^9}, 
   3.795727852672772*^9, 3.795728011194214*^9, 3.795872232707498*^9, 
   3.795872509308322*^9, {3.7958726944287167`*^9, 3.795872703106175*^9}, {
   3.7958730092852163`*^9, 3.795873025681429*^9}, {3.7958733763134336`*^9, 
   3.7958733773763323`*^9}, 3.797003416230397*^9, {3.797003452706653*^9, 
   3.797003479599972*^9}, 3.7976162727465477`*^9, 3.797616417902067*^9, 
   3.7976172590004053`*^9, 3.7976246306557493`*^9, 3.797624703695953*^9, 
   3.797625159082967*^9},
 CellTags->"Subroutines",
 CellLabel->"Out[9]=",ExpressionUUID->"00fdb915-b85e-49e6-af5e-86b3624314e2"]
}, Open  ]]
},
InitializationCellEvaluation->True,
InitializationCellWarning->False,
WindowSize->{1920, 1035},
WindowMargins->{{Automatic, -278}, {753, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Subroutines"->{
  Cell[580, 22, 21499, 455, 19, "Input",ExpressionUUID->"53a05a53-bebd-41d8-a437-67f0abca7cf6",
   CellOpen->False,
   InitializationCell->True,
   CellTags->"Subroutines"],
  Cell[22082, 479, 12021, 224, 477, "Output",ExpressionUUID->"00fdb915-b85e-49e6-af5e-86b3624314e2",
   CellOpen->True,
   CellTags->"Subroutines"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Subroutines", 34484, 718}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 21499, 455, 19, "Input",ExpressionUUID->"53a05a53-bebd-41d8-a437-67f0abca7cf6",
 CellOpen->False,
 InitializationCell->True,
 CellTags->"Subroutines"],
Cell[22082, 479, 12021, 224, 477, "Output",ExpressionUUID->"00fdb915-b85e-49e6-af5e-86b3624314e2",
 CellOpen->True,
 CellTags->"Subroutines"]
}, Open  ]]
}
]
*)

